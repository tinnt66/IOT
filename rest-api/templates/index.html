<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Sensor Dashboard - Real-time Monitoring</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
</head>

<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <h1>IoT Sensor Dashboard</h1>
            <div class="connection-status">
                <span id="status-indicator" class="status-dot"></span>
                <span id="status-text">Connecting...</span>
            </div>
        </header>

        <nav class="top-nav" aria-label="Dashboard Navigation">
            <button class="nav-item active" id="nav-realtime" type="button">Realtime</button>
            <button class="nav-item" id="nav-database" type="button">Database</button>
        </nav>

        <div id="view-realtime">
            <!-- Statistics Cards -->
            <section class="stats-grid">
                <div class="stat-card">
                    <div class="stat-label">Total RS485 Samples</div>
                    <div class="stat-value" id="rs485-count">-</div>
                </div>
                <div class="stat-card adxl-1">
                    <div class="stat-label">Z1 Latest Value</div>
                    <div class="stat-value" id="adxl1-value">-</div>
                    <div class="stat-unit">Channel</div>
                </div>
                <div class="stat-card adxl-2">
                    <div class="stat-label">Z2 Latest Value</div>
                    <div class="stat-value" id="adxl2-value">-</div>
                    <div class="stat-unit">Channel</div>
                </div>
                <div class="stat-card adxl-3">
                    <div class="stat-label">Z3 Latest Value</div>
                    <div class="stat-value" id="adxl3-value">-</div>
                    <div class="stat-unit">Channel</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Latest Update</div>
                    <div class="stat-value" id="last-update">-</div>
                </div>
            </section>

            <!-- Latest RS485 Data -->
            <section class="data-section">
                <h2>Latest RS485 Sensor Data</h2>
                <div class="sensor-grid">
                    <div class="sensor-tile temp">
                        <div class="sensor-icon">Temp</div>
                        <div class="sensor-label">Temperature</div>
                        <div class="sensor-value" id="temp-value">-</div>
                        <div class="sensor-unit">°C</div>
                    </div>

                    <div class="sensor-tile humidity">
                        <div class="sensor-icon">Hum</div>
                        <div class="sensor-label">Humidity</div>
                        <div class="sensor-value" id="humidity-value">-</div>
                        <div class="sensor-unit">%</div>
                    </div>

                    <div class="sensor-tile wind-dir">
                        <div class="sensor-icon">Dir</div>
                        <div class="sensor-label">Wind Direction</div>
                        <div class="sensor-value" id="wind-dir-value">-</div>
                        <div class="sensor-unit" id="wind-dir-deg">-</div>
                    </div>

                    <div class="sensor-tile wind-speed">
                        <div class="sensor-icon">Wind</div>
                        <div class="sensor-label">Wind Speed</div>
                        <div class="sensor-value" id="wind-speed-value">-</div>
                        <div class="sensor-unit">m/s</div>
                    </div>
                </div>
            </section>

            <!-- Latest ADXL Data -->
            <section class="data-section">
                <h2>Latest ADXL Accelerometer Batch</h2>
                <div class="adxl-info">
                    <div class="info-item">
                        <span class="info-label">Chunk Start:</span>
                        <span class="info-value" id="adxl-chunk">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Sample Count:</span>
                        <span class="info-value" id="adxl-samples">-</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Frequency:</span>
                        <span class="info-value" id="adxl-freq">-</span>
                    </div>
                </div>
            </section>

            <!-- Charts -->
            <section class="data-section">
                <div class="section-header">
                    <h2>Charts</h2>
                    <button class="btn" id="btn-toggle-vibration" type="button">Show Vibration Charts</button>
                </div>

                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-title">Temperature &amp; Humidity</div>
                        <div class="chart-wrap">
                            <canvas id="chart-temp-hum"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="chart-title">Wind Speed</div>
                        <div class="chart-wrap">
                            <canvas id="chart-wind-speed"></canvas>
                        </div>
                    </div>
                </div>

                <div class="vibration-row" id="vibration-charts-row" style="display: none;">
                    <div class="chart-card">
                        <div class="chart-wrap chart-wrap-tall">
                            <canvas id="chart-z1"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-wrap chart-wrap-tall">
                            <canvas id="chart-z2"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-wrap chart-wrap-tall">
                            <canvas id="chart-z3"></canvas>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div id="view-database" style="display: none;">
            <section class="data-section">
                <div class="section-header">
                    <h2>Database Data</h2>
                    <button class="btn" id="btn-db-refresh" type="button">Refresh</button>
                </div>

                <div class="db-tabs">
                    <button class="tab-item active" id="db-tab-rs485" type="button">RS485 Samples</button>
                    <button class="tab-item" id="db-tab-adxl" type="button">ADXL Batches</button>
                </div>

                <div class="db-panel" id="db-panel-rs485">
                    <div class="filter-row">
                        <div class="filter-item">
                            <label for="rs485-start">From</label>
                            <input class="input" id="rs485-start" type="datetime-local">
                        </div>
                        <div class="filter-item">
                            <label for="rs485-end">To</label>
                            <input class="input" id="rs485-end" type="datetime-local">
                        </div>
                        <div class="filter-actions">
                            <button class="btn" id="btn-rs485-apply" type="button">Apply</button>
                            <button class="btn" id="btn-rs485-csv" type="button">Export CSV</button>
                            <button class="btn" id="btn-rs485-xlsx" type="button">Export Excel</button>
                        </div>
                    </div>

                    <div class="table-wrap">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Time</th>
                                    <th>Temp (°C)</th>
                                    <th>Hum (%)</th>
                                    <th>Wind Dir</th>
                                    <th>Wind (m/s)</th>
                                    <th>Created</th>
                                </tr>
                            </thead>
                            <tbody id="rs485-table-body">
                                <tr><td colspan="7" class="muted">No data</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="db-panel" id="db-panel-adxl" style="display: none;">
                    <div class="filter-row">
                        <div class="filter-item">
                            <label for="adxl-start">From</label>
                            <input class="input" id="adxl-start" type="datetime-local">
                        </div>
                        <div class="filter-item">
                            <label for="adxl-end">To</label>
                            <input class="input" id="adxl-end" type="datetime-local">
                        </div>
                        <div class="filter-actions">
                            <button class="btn" id="btn-adxl-apply" type="button">Apply</button>
                            <button class="btn" id="btn-adxl-csv" type="button">Export CSV</button>
                            <button class="btn" id="btn-adxl-xlsx" type="button">Export Excel</button>
                        </div>
                    </div>

                    <div class="table-wrap">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Chunk Start (us)</th>
                                    <th>Fs (Hz)</th>
                                    <th>Sample Count</th>
                                    <th>Created</th>
                                </tr>
                            </thead>
                            <tbody id="adxl-table-body">
                                <tr><td colspan="5" class="muted">No data</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
        </div>


    </div>

    <script src="{{ url_for('static', filename='js/dashboard.js') }}"></script>
</body>

</html>
